#:kivy 2.1.0
#:import NoTransition kivy.uix.screenmanager.NoTransition
#:import MapView kivy.garden.mapview.MapView
#:import MapMarkerPopup kivy.garden.mapview.MapMarkerPopup


<MainWindow>:
    BoxLayout:
        orientation: "vertical"
		# header layout
        BoxLayout:
            id: header_layout
            orientation: "horizontal"
            padding: 20
			size_hint_y: 0.1
            Image:
                id: logo
                source:'asset/logo_labtek.png'
                size_hint_x: 0.2
                allow_stretch: True

            BoxLayout:
                orientation: "vertical"
                padding: 0, 15

                Label:
                    id: subtitle            
                    text: "GROUND PENETRATING RADAR (GPR)"
                    bold: True
                    font_size: 80
                    size_hint_y: 2
                    color: 0, 0, 0
                
            # Image:
            #     id: powered_by
            #     source:'asset/powered.png'
            #     size_hint_x: 0.05
            #     allow_stretch: True

		
		# comm header layout
		BoxLayout:
			id: comm_header_layout
			orientation: "vertical"
			size_hint_y: 0.14
			padding:20
			spacing:20

			Label:
				id : label_page
				text: "SETTING SCREEN"
				bold: True
				font_size: 64
				color: 0, 0, 0

			Label:
				id : label_notif
				size_hint_y: 0.4
				text: "notification"
				bold: True
				font_size: 32
				color: 1, 0, 0

			BoxLayout:
				orientation: "horizontal"
				spacing:50

				Label:
					text: "DEVICE COMMUNICATION PORT"
					font_size: 44
					color: 0, 0, 0

				TextInput:
					id: txt_com
					multiline: False
					font_size: 36

				Button:
					id: bt_refresh
					text: "REFRESH"
					font_size: 44
					on_press: root.refresh()

				Button:
					id: bt_open_close_serial
					text: "OPEN COMMUNICATION"
					font_size: 44
					disabled: True
					on_press: root.open_close_serial()

		# setting layout
		BoxLayout:
			id: layout_setting
			orientation: "vertical"
			size_hint_y: 0.6
			padding:20
			spacing:20

			BoxLayout:
				orientation: "horizontal"
				size_hint_y: 0.7
				BoxLayout:
					orientation: "vertical"
					canvas.before:
						Color:
							rgba: 0.5, 0, 0, 1
						Line:
							width: 2
							rectangle: self.x, self.y, self.width, self.height

					Label:
						text: "WAVEFORM"
						bold: True
						font_size: 44
						color: 0, 0, 0
						size_hint_y: 0.25

					Label:
						text: ""
						size_hint_y: 0.1

					GridLayout:
						cols:2
						row_force_default: True
						row_default_height: 120

						CheckBox:
							group: "waveform"
							color: 0.5, 0, 0
							# size_hint_x: None
							size_hint: None, None
							size: 96, 96
							width: 300
							# check_size:200
							on_active: root.checkbox_waveform_click(self, self.active, "TRIANGLE")

						Label:
							text: "TRIANGLE"
							text_size: self.size
							halign: "left"
							valign: "middle"
							font_size:44
							color: 0, 0, 0

						CheckBox:
							group: "waveform"
							color: 0.5, 0, 0
							size_hint_x: None
							width: 300
							on_active: root.checkbox_waveform_click(self, self.active, "SQUARE")
							
						Label:
							text: "SQUARE"
							text_size: self.size
							halign: "left"
							valign: "middle"
							font_size:44
							color: 0, 0, 0

						CheckBox:
							group: "waveform"
							color: 0.5, 0, 0
							size_hint_x: None
							width: 300
							on_active: root.checkbox_waveform_click(self, self.active, "SAWTOOTH")		

						Label:
							text: "SAWTOOTH"
							text_size: self.size
							halign: "left"
							valign: "middle"
							font_size:44
							color: 0, 0, 0

					Label:
						id: output_label
						text: ""
						font_size:36
						bold: True
						color: 0, 0, 0
						size_hint_y: 0.7

				BoxLayout:
					orientation: "vertical"
					canvas.before:
						Color:
							rgba: 0, 0.5, 0, 1
						Line:
							width: 2
							rectangle: self.x, self.y, self.width, self.height
					
					Label:
						text: "FREQUENCY"
						bold: True
						font_size: 44
						color: 0, 0, 0
						size_hint_y: 0.1

					GridLayout:
						cols:2

						Label:
							text: "Min"
							font_size:40
							color: 0, 0, 0

						Label:
							text: "Max"
							font_size:40
							color: 0, 0, 0

						Slider:
							id: slider_min
							min: 199.99
							max: 200.01
							step: 0.001
							value: 199.995
							orientation: 'vertical'

						Slider:
							id: slider_max
							min: 199.99
							max: 200.01
							step: 0.001
							value: 200.005
							orientation: 'vertical'

						Label:
							text: f"{slider_min.value:2.3f} Mhz" 
							font_size:36
							color: 0, 0, 0
							bold: True
						
						Label:
							text:  f"{slider_max.value:2.3f} Mhz" 
							font_size:36
							color: 0, 0, 0
							bold: True

				BoxLayout:
					orientation: "vertical"
					canvas.before:
						Color:
							rgba: 0, 0, 0.5, 1
						Line:
							width: 2
							rectangle: self.x, self.y, self.width, self.height

					Label:
						text: "TIME PERIODE"
						bold: True
						font_size: 44
						color: 0, 0, 0
						size_hint_y: 0.1

					GridLayout:
						cols:1
						Label:
							text: ""
							size_hint_y: 0.4
							font_size:44
							
						Slider:
							id: slider_interval
							min: 10
							max: 100
							step: 10
							orientation: 'vertical'

						Label:
							text: str(slider_interval.value) + " milli second" 
							font_size:36
							color: 0, 0, 0
							bold: True

				BoxLayout:
					orientation: "vertical"
					canvas.before:
						Color:
							rgba: 0.5, 0, 0, 1
						Line:
							width: 2
							rectangle: self.x, self.y, self.width, self.height

					Label:
						text: "MEASUREMENT METHOD"
						bold: True
						font_size: 44
						color: 0, 0, 0
						size_hint_y: 0.25

					Label:
						text: ""
						size_hint_y: 0.1

					GridLayout:
						cols:2
						row_force_default: True
						row_default_height: 120

						#CheckBox:
						#	group: "method"
						#	color: 0.5, 0, 0
						#	size_hint_x: None
						#	width: 300
						#	on_active: root.checkbox_method_click(self, self.active, "ODOMETRY")

						#Label:
						#	text: "ODOMETRY"
						#	text_size: self.size
						#	halign: "left"
						#	valign: "middle"
						#	font_size:44
						#	color: 0, 0, 0

						CheckBox:
							group: "method"
							color: 0.5, 0, 0
							size_hint_x: None
							width: 300
							on_active: root.checkbox_method_click(self, self.active, "CONTINUOUS ")
							
						Label:
							text: "CONTINUOUS"
							text_size: self.size
							halign: "left"
							valign: "middle"
							font_size:44
							color: 0, 0, 0

						CheckBox:
							group: "method"
							color: 0.5, 0, 0
							size_hint_x: None
							width: 300
							on_active: root.checkbox_method_click(self, self.active, "MANUAL")		

						Label:
							text: "MANUAL"
							text_size: self.size
							halign: "left"
							valign: "middle"
							font_size:44
							color: 0, 0, 0

					Label:
						id: output_label_method
						text: ""
						font_size:36
						bold: True
						color: 0, 0, 0
						size_hint_y: 0.7


			# graph carrier layout
			BoxLayout:
				id: layout_graph_carrier
				orientation: "vertical"
				size_hint_y: 0.3
				padding:20
				spacing:20			
		
		# graph layout
		BoxLayout:
			id: layout_graph
			orientation: "vertical"
			size_hint_y: 0.6
			padding:20
			spacing:20

			BoxLayout:
				id: layout_graph_signal
				orientation: "vertical"

			BoxLayout:
				size_hint_y: 0.1
				padding:30
				spacing:30
				
				Slider:
					id: slider_distance
					min: 0
					max: 99
					step: 0.001
					orientation: 'horizontal'
					size_hint_x: 0.72
					padding:150

				Label:
					id: txt_slider_distance
					text: "DISTANCE " + str(slider_distance.value) + " m" 
					font_size:36
					color: 0, 0, 0
					bold: True
					size_hint_x: 0.28

		# map layout
		BoxLayout:
			id: layout_map
			orientation: "vertical"
			size_hint_y: 0.6
			padding:20
			spacing:20
			
			BoxLayout:
				orientation: "horizontal"
				size_hint_y: 0.08
				spacing:20
				Label:
					text: "LONGITUDE"
					font_size: 44
					color: 0, 0, 0
				
				TextInput:
					id: txt_lon
					text: str(root.lon)
					multiline: False
					font_size: 44
					halign: "center"

				Label:
					text: "LATITUDE"
					font_size: 44
					color: 0, 0, 0
				
				TextInput:
					id: txt_lat
					text: str(root.lat)
					multiline: False
					font_size: 44
					halign: "center"

				Label:
					text: "ZOOM:"
					font_size: 44
					color: 0, 0, 0

				Label:
					id: txt_zoom
					text: str(slider_zoom.value)
					font_size: 44
					color: 0, 0, 0

				Slider:
					id: slider_zoom
					min: 1
					max: 19
					step: 1
					value: root.zoom

				Button:
					text: "MARK"
					font_size: 44
					on_press: root.map_mark()
			Label:
				text: "Available in Paid Version"
				font_size: 44
				color: 1, 0, 0
				size_hint_y: 0.1


			MapView:
				id: map_view
				lon: root.lon
				lat: root.lat
				zoom: root.zoom

				MapMarkerPopup:
					id: map_marker
					source: "asset/marker.png"
					lon: root.lon
					lat: root.lat

		# button interfacing layout
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: 0.08
			padding:20	
			spacing:50			
			Button:
				id: bt_send_signal
				text: "GENERATE SIGNAL"
				font_size: 44
				disabled: True
				on_press: root.send_signal()

			Button:
				id: bt_update_graph
				text: "UPDATE GRAPH"
				font_size: 44
				disabled: True
				on_press: root.request_graph()

			Button:
				id: bt_save_data
				text: "SAVE DATA"
				font_size: 44
				disabled: True
				on_press: root.save_data()

			Button:
				id: bt_save_graph
				text: "SAVE GRAPH"
				font_size: 44
				disabled: True
				on_press: root.save_graph()

			Button:
				id: bt_update_map
				text: "UPDATE MAP"
				font_size: 44
				disabled: True
				background_color: 0.9, 0.9, 0
				#on_press: root.request_map()

		# button navigation layout
		BoxLayout:
			orientation: "horizontal"
			size_hint_y: 0.08
			padding:20
			spacing:50

			Button:
				id: bt_screen_setting
				text: "SETTING"
				font_size: 44
				on_press: root.setting_screen()

			Button:
				id: bt_screen_graph
				text: "GRAPH"
				font_size: 44
				on_press: root.graph_screen()

			Button:
				id: bt_screen_map
				text: "MAP"
				font_size: 44
				on_press: root.map_screen()

			Button:
				id: bt_quit
				text: "EXIT"
				font_size: 44
				on_press: root.exec_exit()

			Button:
				id: bt_shutdown
				text: "SHUTDOWN"
				font_size: 44
				on_press: root.exec_shutdown()

		#support
		Label:
			text: "Supported by: PT. UNGGUL NUSA TEKNIKA"
			font_size: 30
			size_hint_y: 0.02
			halign: 'right'
			valign: 'center'
			color: 0, 0, 0




